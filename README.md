## 提交记录

- 2017/11/24 第一次提交 测试新增用户 ykh 2017/11/24 13:34
- 2017/11/18 第一次提交 新增评论敏感词检测 ykh 2017/11/18 15:42
- 2017/11/15 第一次提交 加入django-constance ykh 2017/11/15 18:13
- 2017/11/10 第二次提交 完成用户间关注关系映射至好友关系 ykh 2017/11/10 17:43
- 2017/11/10 第一次提交 完成推荐帖子接口 ykh 2017/11/10 17:17
- 2017/11/08 第一次提交 完成推荐模型 ykh 2017/11/8 18:23
- 2017/10/29 第一次提交 完成收藏夹全部功能 ykh 2017/10/29 16:32
- 2017/10/27 第一次提交 加入xadmin ykh 2017/10/27 15:35
- 2017/10/26 第一次提交 完成附近帖子 ykh 2017/10/26 0:36
- 2017/10/24 第一次提交 更新经纬度存储方式、更新humanize_errors转义方法 ykh 2017/10/24 0:00
- 2017/10/22 第一次提交 优化用户full_name显示;完成好友、帖子、评论、点赞部分推送功能 ykh 2017/10/22 11:37
- 2017/10/19 第一次提交 帖子返回是否点赞参数 ykh 2017/10/19 23:44
- 2017/10/18 第八次提交 批量上传附件 ykh 2017/10/18 23:28
- 2017/10/18 第七次提交 移除帖子先前关联的图片模型 ykh 2017/10/18 22:44
- 2017/10/18 第六次提交 帖子多图使用附件 ykh 2017/10/18 22:40
- 2017/10/18 第五次提交 帖子视频使用附件 ykh 2017/10/18 22:07
- 2017/10/18 第四次提交 用户头像使用附件 ykh 2017/10/18 21:47
- 2017/10/18 第三次提交 文件CRUD ykh 2017/10/18 21:06
- 2017/10/18 第二次提交 加入附件模型、优化手机号码正则 ykh 2017/10/18 20:01
- 2017/10/18 第一次提交 为好友时用户列表返回好友备注名 ykh 2017/10/18 19:30
- 2017/10/15 第四次提交 指定好友看故事黑名单 ykh 2017/10/15 15:31
- 2017/10/15 第三次提交 评论点赞 ykh 2017/10/15 15:12
- 2017/10/15 第一次提交 帖子列表详情返回评论总数、帖子详情返回前10条评论 ykh 2017/10/15 15:04
- 2017/10/15 第一次提交 帖子评论CRUD ykh 2017/10/15 14:58
- 2017/10/14 第四次提交 帖子点赞用户列表由随帖子详情返回改为单独返回 ykh 2017/10/14 13:53
- 2017/10/14 第三次提交 完成帖子点赞 ykh 2017/10/14 13:46
- 2017/10/14 第二次提交 验证帖子中图片删除权限、对帖子修改和删除进行权限控制 ykh 2017/10/14 11:53
- 2017/10/14 第一次提交 帖子新增、修改 ykh 2017/10/14 11:28
- 2017/10/12 第二次提交 列表帖子;控制不同类型帖子只返回对应类型的内容 ykh 2017/10/12 19:47
- 2017/10/12 第一次提交 帖子serializer、filter;图片、视频文件大小限制 ykh 2017/10/12 19:02
- 2017/10/11 第一次提交 TODO:帖子serializer ykh 2017/10/11 18:27
- 2017/10/10 第一次提交 再次调整Http StatusCode-200时返回格式 加入code\msg ykh 2017/10/10 18:52
- 2017/10/09 第一次提交 调整成功返回数据为json格式 ykh 2017/10/9 18:37
- 2017/10/05 第一次提交 完成帖子模型 ykh 2017/10/5 16:32
- 2017/10/05 第一次提交 初步集成极光推送 ykh 2017/10/5 15:35
- 2017/10/02 第一次提交 好友关系删除时，若是拉黑关系则删除融云上的拉黑关系。 ykh 2017/10/2 15:36
- 2017/09/29 第三次提交 修正分页备注 ykh 2017/9/30 0:08
- 2017/09/29 第二次提交 同步黑名单至融云 ykh 2017/9/29 23:24
- 2017/09/29 第一次提交 完成IM Token获取、刷新 ykh 2017/9/29 21:49
- 2017/09/28 第一次提交 修正短信发送类因为单例模式导致随机数、时间戳不变化的错误 ykh 2017/9/28 14:56
- 2017/09/27 第二次提交 完成使用验证码登陆 ykh 2017/9/27 19:45
- 2017/09/27 第一次提交 实现阿里云SMS短信封装 ykh 2017/9/27 19:29
- 2017/09/26 第二次提交 完成关注 ykh 2017/9/26 20:52
- 2017/09/26 第一次提交 实现阿里云SMS发送短信功能 ykh 2017/9/26 18:04
- 2017/09/24 第二次提交 加入好友过滤、检索、排序 ykh 2017/9/24 16:12
- 2017/09/24 第一次提交 完成好友体系 ykh 2017/9/24 15:51
- 2017/09/23 第四次提交 加入好友模型 ykh 2017/9/23 20:56
- 2017/09/23 第三次提交 加入阿里大于短信发送 ykh 2017/9/23 14:23
- 2017/09/23 第二次提交 新增README;微调代码 ykh 2017/9/23 13:56
- 2017/09/23 第一次提交 使用阿里云OSS作为默认存储;使用django-clean-up自动清理旧文件 ykh 2017/9/23 11:56
- 2017/09/22 第八次提交 将姓名修改为昵称 ykh 2017/9/22 22:59
- 2017/09/22 第七次提交 禁用用户删除、控制用户只可部分更新自己的信息;加入media_url ykh 2017/9/22 22:31
- 2017/09/22 第六次提交 用户模型加入邮件、短信验证码设置号码和用途唯一 ykh 2017/9/22 22:04
- 2017/09/22 第五次提交 加入DRF静态文件 ykh 2017/9/22 21:44
- 2017/09/22 第四次提交 新增协议、协议是否授权接口 ykh 2017/9/22 21:38
- 2017/09/22 第三次提交 新增协议许可模型 ykh 2017/9/22 20:42
- 2017/09/22 第二次提交 加入JWT Token刷新、认证接口 ykh 2017/9/22 20:22
- 2017/09/22 第一次提交 加入短信验证码模型;加入JWT认真;完成用户注册、登陆、找回密码、修改密码、修改手机号码、发送短信验证码、查看用户列表及详情、检索用户是否存在 ykh 2017/9/22 20:09
- 2017/09/21 第二次提交 新增用户模型、admin适配移动端 ykh 2017/9/21 23:21
- 2017/09/21 第一次提交 初始化项目 ykh 2017/9/21 22:20

## 说明
- 使用JWT进行认证，所有需要身份认证的Http请求均需要加入Token(令牌)，其最大有效期为2天，可以使用7天内的旧令牌换取新令牌。建议使用Http拦截器实现，其Http请求头部格式如下：

		Authorization：Token xxx
- 站点[Oasis](http://60.205.186.74)上DRF的Session认证已关闭，导致可视化浏览界面无法直接使用，如需使用请下载Chrome插件[modheader](https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj)，并为浏览器配置对应的请求头部进行查看。

- 对于所有列表接口，如url为`/list/`:

	- 希望以性别升序、ID降序排列，请求url为`/user/?ordering=gender,-id`;
	- 希望得到性别为男的列表，请求url为`/user/?gender=1`；
	- 希望搜索用户时，请求url为`/user/?search=xxx`；
	- 希望每页显示10条数据，请求url为`/user/?page_size=10`；
	- 希望访问未分页的列表，请求url为`/user/?page_size=0`；
	- 希望访问列表的第二页，请求url为`/user/?page=2`；
	- 排序、过滤、检索、每页个数、页数条件可以混合使用，请求url可为`/user/?ordering=gender,-id&gender=1&search=xxx&page_size=10&page=2`；


## 配置相关
- 生产环境置`DEBUG=False`并重设域名
- 创建虚拟环境

		python -m venv environment

- 开启虚拟环境

	Windows：

	    cd environment;
	    cd Scripts;
	    activate.bat;
	    cd ..;
	    cd ..;

	Linux:

	    source environment/bin/activate

- 安装插件

    	pip install -r requirements.txt -i https://pypi.douban.com/simple

- 同步数据库

	    python manage.py makemigrations
	    python manage.py migrate

- 创建超级管理员

    	python manage.py createsuperuser

- 开启测试服务器

    	python manage.py runserver 0:80

- [apache2配置](http://blog.dreamgotech.com/article/49/)

## App说明

### user 用户体系
- User 用户
- TelVerify 短信验证码
- Agreement 协议许可
